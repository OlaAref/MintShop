<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<div th:replace="fragments/head :: head('My Reviews')"></div>
</head>
<body class="d-flex flex-column h-100">

	
	<div th:replace="fragments/navbar :: navbar-content"></div>
	
	<div class="wrapper min-vh-100">
		
		<!-- Search Bar -->
		<div class="container justify-content-center mt-4">
			<div class="row">
				
				<form th:action="@{/review/page/1}" method="get">
					<div class="col-md-8">
						<div class="input-group mb-3">
							<input hidden="hidden" name="sortField" th:value="${sortField}">
							<input hidden="hidden" name="sortDir" th:value="${sortDir}">
							<input type="text" class="form-control input-text" placeholder="Search reviews...." 
									name="keyword" th:value="${keyword}" required>
							<div class="input-group-append">
								<button class="btn btn-outline-warning btn-lg" type="submit"><i class="fa fa-search"></i></button>
							</div>
						</div>       
					</div>   
				</form>     
			    
			</div>
		</div>
	
		<!-- Page Content  -->
        <div id="content">
        	<div class="table-responsive">
	            <table class="table table-striped table-hover">
	  			<thead>
				    <tr class="table-dark">
				    
				      <th th:replace="fragments/column-link :: column-link('id', 'ID')"/>
				      <th th:replace="fragments/column-link :: column-link('product', 'Product')"></th>
				      <th th:replace="fragments/column-link :: column-link('headline', 'Headline')"></th>
				      <th th:replace="fragments/column-link :: column-link('rating', 'Rating')"></th>
				      <th th:replace="fragments/column-link :: column-link('createdTime', 'Review Time')"></th>
				      
				      <th>Details</th>

				    </tr>
				  </thead>
				  <tbody>
				  	<tr th:each="review : ${reviews}">
				   	  <td th:text="${review.id}"></td>
				     
				      <td>
				      	<a class="product-link" th:href="@{'/p/'+${review.product.alias}}" title="View product details" target="_blank">[[${review.product.shortName}]]</a>
				      </td>
				      <td th:text="${review.headline}"></td>
				      <td><span th:replace="reviews/review-rating :: reviewRating(${review.rating})"></span></td>
				      
				      <td><div th:replace="fragments/format :: format-time(${review.createdTime})"></div></td>
				      
				      <td><a class="details-link" th:href="@{'/review/details/'+${review.id}}" title="View details of this review"><i class="fas fa-file-alt" style="color: #0e634b"></i></a></td>
				     </tr>
				     
				  </tbody>
	  			</table>
  			</div>
  			
  			<div th:replace="fragments/navigation :: navigation('review')"></div>
			
        </div>
		
	</div>
	
	<div th:replace="fragments/modal-dialog :: delete-dialog"></div>
	<div th:replace="fragments/modal-dialog :: dialog"></div>
	<div th:replace="fragments/modal-dialog :: details-modal(reviewDetailsModal)"></div>

	<div th:replace="fragments/footer :: footer"></div>
	
	<!-- Start Scroll To Top Section -->
    <div class="scroll-top">
        <i class="fas fa-chevron-up fa-3x scroll-icon"></i>
    </div>
	
	
	<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
	<script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
	<script th:src="@{/webjars/font-awesome/js/all.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
	<script th:src="@{/js/plugins.js}"></script>
	<script th:src="@{/js/PNotify.js}"></script>
	
	<script>
		var contextPath = "[[@{/}]]";
		var csrfHeaderName = "[[${_csrf.headerName}]]";
		var csrfValue = "[[${_csrf.token}]]";
		
		 $(document).ready(function() {
    
			 var errorMsg = "[[${errorMessage}]]";
	        if(errorMsg != null && errorMsg != ''){
	        	customeNotice("Error", errorMsg);
	        }
			 
			$(".details-link").click(function(e){
				e.preventDefault();
				var linkUrl = $(this).attr("href");
				$("#reviewDetailsModal").modal("show").find(".modal-content").load(linkUrl);
				
			});
		        
		 });
	</script>
</body>
</html>